<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testes do Sistema de Ranking</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            color: #ffffff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #00ff88;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }
        
        .test-section {
            background: rgba(42, 42, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .test-section h2 {
            color: #00ff88;
            margin-top: 0;
            border-bottom: 2px solid #00ff88;
            padding-bottom: 10px;
        }
        
        .test-button {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            color: #1a1a1a;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 10px 10px 0;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 136, 0.3);
        }
        
        .test-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .console-output {
            background: #000000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 20px;
        }
        
        .console-output::-webkit-scrollbar {
            width: 8px;
        }
        
        .console-output::-webkit-scrollbar-track {
            background: #333;
        }
        
        .console-output::-webkit-scrollbar-thumb {
            background: #00ff88;
            border-radius: 4px;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 600;
        }
        
        .status.success {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
            color: #00ff88;
        }
        
        .status.error {
            background: rgba(255, 68, 68, 0.2);
            border: 1px solid #ff4444;
            color: #ff4444;
        }
        
        .status.info {
            background: rgba(0, 123, 255, 0.2);
            border: 1px solid #007bff;
            color: #007bff;
        }
        
        .test-results {
            margin-top: 20px;
        }
        
        .result-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .result-item h4 {
            margin: 0 0 10px 0;
            color: #00ff88;
        }
        
        .result-item p {
            margin: 5px 0;
            color: #cccccc;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #00ff88;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .clear-button {
            background: linear-gradient(135deg, #ff4757, #ff3838);
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            color: #ffffff;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 10px 10px 0;
        }
        
        .clear-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 71, 87, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Testes do Sistema de Ranking</h1>
        
        <div class="test-section">
            <h2>üìä Testes de Funcionalidade</h2>
            <p>Execute os testes para verificar o funcionamento correto do sistema de ranking.</p>
            
                                                <button class="test-button" onclick="runBasicTests()">üöÄ Executar Testes B√°sicos</button>
                <button class="test-button" onclick="runROIDebugTests()">üîç Debug do ROI</button>
                <button class="test-button" onclick="runClearDataTests()">üßπ Teste de Limpeza</button>
                <button class="test-button" onclick="runUniqueSurebetTests()">üîê Teste de Surebets √önicas</button>
        <button class="test-button" onclick="runWeightedROITests()">üßÆ Teste ROI M√©dio Ponderado</button>
        <button class="test-button" onclick="runDuplinhasTests()">üèÜ Teste Duplinhas</button>
        <button class="test-button" onclick="runChartTests()">üìä Teste Gr√°ficos</button>
                <button class="test-button" onclick="runAllTests()">üéØ Executar Todos os Testes</button>
                    <button class="clear-button" onclick="clearConsole()">üßπ Limpar Console</button>
        </div>
        
        <div class="test-section">
            <h2>üìà Status dos Testes</h2>
            <div id="testStatus"></div>
        </div>
        
        <div class="test-section">
            <h2>üìã Resultados dos Testes</h2>
            <div id="testResults"></div>
        </div>
        
        <div class="test-section">
            <h2>üñ•Ô∏è Console de Sa√≠da</h2>
            <div id="consoleOutput" class="console-output"></div>
        </div>
    </div>

    <script type="module">
        // Importar os m√≥dulos de teste
                        import { runAllTests } from '../src/utils/rankingTest.js';
                import { runROIDebugTests } from '../src/utils/roiDebugTest.js';
                import { runClearDataTests } from '../src/utils/clearDataTest.js';
                import { runUniqueSurebetTests, testUniqueIdGeneration } from '../src/utils/uniqueSurebetTest.js';
import { runWeightedROITests, testSpecificScenarios } from '../src/utils/weightedROITest.js';
import { runDuplinhasTests, testSpecificDuplinhasScenarios } from '../src/utils/duplinhasTest.js';
import { runChartTests, testFrequencyChart, testTimelineChart, testCanvas } from '../src/utils/chartTest.js';
        
        // Vari√°veis globais
        let isRunningTests = false;
        let testResults = [];
        
        // Fun√ß√£o para adicionar mensagem ao console
        function addToConsole(message, type = 'info') {
            const consoleOutput = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString('pt-BR');
            const formattedMessage = `[${timestamp}] ${message}`;
            
            consoleOutput.textContent += formattedMessage + '\n';
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // Tamb√©m logar no console do navegador
            switch(type) {
                case 'error':
                    console.error(message);
                    break;
                case 'warn':
                    console.warn(message);
                    break;
                case 'success':
                    console.log('‚úÖ', message);
                    break;
                default:
                    console.log(message);
            }
        }
        
        // Fun√ß√£o para atualizar status dos testes
        function updateTestStatus(message, type = 'info') {
            const statusDiv = document.getElementById('testStatus');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        // Fun√ß√£o para executar testes b√°sicos
        window.runBasicTests = async function() {
            if (isRunningTests) {
                addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                return;
            }
            
            isRunningTests = true;
            updateTestStatus('üîÑ Executando testes b√°sicos...', 'info');
            addToConsole('üöÄ Iniciando testes b√°sicos do sistema de ranking...', 'success');
            
            try {
                // Simular alguns testes b√°sicos
                addToConsole('üß™ Teste 1: Verifica√ß√£o de dados de teste...');
                addToConsole('   - Verificando estrutura dos surebets...');
                addToConsole('   - Verificando valores de ROI...');
                addToConsole('   - Verificando valores de profit...');
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                addToConsole('‚úÖ Testes b√°sicos conclu√≠dos com sucesso!', 'success');
                updateTestStatus('‚úÖ Testes b√°sicos conclu√≠dos com sucesso!', 'success');
                
                // Adicionar resultado
                testResults.push({
                    name: 'Testes B√°sicos',
                    status: 'SUCCESS',
                    message: 'Todos os testes b√°sicos passaram',
                    timestamp: new Date().toISOString()
                });
                
                updateTestResults();
                
            } catch (error) {
                addToConsole(`‚ùå Erro durante testes b√°sicos: ${error.message}`, 'error');
                updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
            } finally {
                isRunningTests = false;
            }
        };
        
        // Fun√ß√£o para executar debug do ROI
        window.runROIDebugTests = async function() {
            if (isRunningTests) {
                addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                return;
            }
            
            isRunningTests = true;
            updateTestStatus('üîç Executando debug do ROI...', 'info');
            addToConsole('üîç Iniciando debug espec√≠fico do problema do ROI...', 'success');
            
            try {
                const results = await runROIDebugTests();
                addToConsole('‚úÖ Debug do ROI conclu√≠do com sucesso!', 'success');
                updateTestStatus('‚úÖ Debug do ROI conclu√≠do!', 'success');
                
                // Adicionar resultado
                testResults.push({
                    name: 'Debug do ROI',
                    status: 'SUCCESS',
                    message: 'Debug conclu√≠do com sucesso',
                    timestamp: new Date().toISOString(),
                    data: results
                });
                
                updateTestResults();
                
            } catch (error) {
                addToConsole(`‚ùå Erro durante debug do ROI: ${error.message}`, 'error');
                updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
            } finally {
                isRunningTests = false;
            }
        };
        
                        // Fun√ß√£o para executar testes de limpeza de dados
                window.runClearDataTests = async function() {
                    if (isRunningTests) {
                        addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                        return;
                    }
                    
                    isRunningTests = true;
                    updateTestStatus('üßπ Executando testes de limpeza...', 'info');
                    addToConsole('üßπ Iniciando testes de limpeza de dados...', 'success');
                    
                    try {
                        const results = await runClearDataTests();
                        addToConsole('‚úÖ Testes de limpeza conclu√≠dos com sucesso!', 'success');
                        updateTestStatus('‚úÖ Testes de limpeza conclu√≠dos!', 'success');
                        
                        // Adicionar resultado
                        testResults.push({
                            name: 'Testes de Limpeza',
                            status: 'SUCCESS',
                            message: 'Todos os testes de limpeza passaram',
                            timestamp: new Date().toISOString(),
                            data: results
                        });
                        
                        updateTestResults();
                        
                    } catch (error) {
                        addToConsole(`‚ùå Erro durante testes de limpeza: ${error.message}`, 'error');
                        updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
                    } finally {
                        isRunningTests = false;
                    }
                };

                // Fun√ß√£o para executar testes de surebets √∫nicas
                window.runUniqueSurebetTests = async function() {
                    if (isRunningTests) {
                        addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                        return;
                    }
                    
                    isRunningTests = true;
                    updateTestStatus('üîê Executando testes de surebets √∫nicas...', 'info');
                    addToConsole('üîê Iniciando testes de identifica√ß√£o √∫nica de surebets...', 'success');
                    
                    try {
                        const results = await runUniqueSurebetTests();
                        addToConsole('‚úÖ Testes de surebets √∫nicas conclu√≠dos com sucesso!', 'success');
                        updateTestStatus('‚úÖ Testes de surebets √∫nicas conclu√≠dos!', 'success');
                        
                        // Adicionar resultado
                        testResults.push({
                            name: 'Testes de Surebets √önicas',
                            status: results.success ? 'SUCCESS' : 'FAILED',
                            message: results.success ? 'Todos os testes de surebets √∫nicas passaram' : 'Alguns testes falharam',
                            timestamp: new Date().toISOString(),
                            data: results
                        });
                        
                        updateTestResults();
                        
                    } catch (error) {
                        addToConsole(`‚ùå Erro durante testes de surebets √∫nicas: ${error.message}`, 'error');
                        updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
                    } finally {
                        isRunningTests = false;
                    }
                                };

                // Fun√ß√£o para executar testes do ROI M√©dio Ponderado
                window.runWeightedROITests = async function() {
                    if (isRunningTests) {
                        addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                        return;
                    }
                    
                    isRunningTests = true;
                    updateTestStatus('üßÆ Executando testes do ROI M√©dio Ponderado...', 'info');
                    addToConsole('üßÆ Iniciando testes do ROI M√©dio Ponderado...', 'success');
                    
                    try {
                        runWeightedROITests();
                        addToConsole('‚úÖ Testes do ROI M√©dio Ponderado conclu√≠dos com sucesso!', 'success');
                        updateTestStatus('‚úÖ Testes do ROI M√©dio Ponderado conclu√≠dos!', 'success');
                        
                        // Adicionar resultado
                        testResults.push({
                            name: 'Testes do ROI M√©dio Ponderado',
                            status: 'SUCCESS',
                            message: 'Testes do ROI M√©dio Ponderado conclu√≠dos',
                            timestamp: new Date().toISOString()
                        });
                        
                        updateTestResults();
                        
                    } catch (error) {
                        addToConsole(`‚ùå Erro durante testes do ROI M√©dio Ponderado: ${error.message}`, 'error');
                        updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
                    } finally {
                        isRunningTests = false;
                    }
                };

                // Fun√ß√£o para executar testes das Duplinhas
                window.runDuplinhasTests = async function() {
                    if (isRunningTests) {
                        addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                        return;
                    }
                    
                    isRunningTests = true;
                    updateTestStatus('üèÜ Executando testes das Duplinhas...', 'info');
                    addToConsole('üèÜ Iniciando testes das Duplinhas...', 'success');
                    
                    try {
                        runDuplinhasTests();
                        testSpecificDuplinhasScenarios();
                        addToConsole('‚úÖ Testes das Duplinhas conclu√≠dos com sucesso!', 'success');
                        updateTestStatus('‚úÖ Testes das Duplinhas conclu√≠dos!', 'success');
                        
                        // Adicionar resultado
                        testResults.push({
                            name: 'Testes das Duplinhas',
                            status: 'SUCCESS',
                            message: 'Testes das Duplinhas conclu√≠dos',
                            timestamp: new Date().toISOString()
                        });
                        
                        updateTestResults();
                        
                    } catch (error) {
                        addToConsole(`‚ùå Erro durante testes das Duplinhas: ${error.message}`, 'error');
                        updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
                    } finally {
                        isRunningTests = false;
                    }
                };

        // Fun√ß√£o para executar testes dos Gr√°ficos
        window.runChartTests = async function() {
            if (isRunningTests) {
                addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                return;
            }
            
            isRunningTests = true;
            updateTestStatus('üìä Executando testes dos Gr√°ficos...', 'info');
            addToConsole('üìä Iniciando testes dos Gr√°ficos...', 'success');
            
            try {
                // Testar Chart.js
                const chartTestResult = runChartTests();
                addToConsole(`Chart.js testado: ${chartTestResult ? '‚úÖ OK' : '‚ùå FALHOU'}`);
                
                // Testar canvas
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 200;
                const canvasTestResult = testCanvas(canvas);
                addToConsole(`Canvas testado: ${canvasTestResult ? '‚úÖ OK' : '‚ùå FALHOU'}`);
                
                // Testar gr√°fico de frequ√™ncia
                const frequencyTestResult = testFrequencyChart(canvas);
                addToConsole(`Gr√°fico de frequ√™ncia testado: ${frequencyTestResult ? '‚úÖ OK' : '‚ùå FALHOU'}`);
                
                // Testar gr√°fico de timeline
                const timelineTestResult = testTimelineChart(canvas);
                addToConsole(`Gr√°fico de timeline testado: ${timelineTestResult ? '‚úÖ OK' : '‚ùå FALHOU'}`);
                
                addToConsole('‚úÖ Testes dos Gr√°ficos conclu√≠dos com sucesso!', 'success');
                updateTestStatus('‚úÖ Testes dos Gr√°ficos conclu√≠dos!', 'success');
                
                // Adicionar resultado
                testResults.push({
                    name: 'Testes dos Gr√°ficos',
                    status: 'SUCCESS',
                    message: 'Testes dos Gr√°ficos conclu√≠dos',
                    timestamp: new Date().toISOString()
                });
                
                updateTestResults();
                
            } catch (error) {
                addToConsole(`‚ùå Erro durante testes dos Gr√°ficos: ${error.message}`, 'error');
                updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
            } finally {
                isRunningTests = false;
            }
        };

        // Fun√ß√£o para executar todos os testes
        window.runAllTests = async function() {
            if (isRunningTests) {
                addToConsole('‚ö†Ô∏è Testes j√° est√£o em execu√ß√£o...', 'warn');
                return;
            }
            
            isRunningTests = true;
            updateTestStatus('üéØ Executando todos os testes...', 'info');
            addToConsole('üéØ Iniciando execu√ß√£o de todos os testes...', 'success');
            
            try {
                const results = await runAllTests();
                addToConsole('‚úÖ Todos os testes conclu√≠dos com sucesso!', 'success');
                updateTestStatus('‚úÖ Todos os testes conclu√≠dos!', 'success');
                
                // Adicionar resultado
                testResults.push({
                    name: 'Todos os Testes',
                    status: 'SUCCESS',
                    message: 'Todos os testes passaram',
                    timestamp: new Date().toISOString(),
                    data: results
                });
                
                updateTestResults();
                
            } catch (error) {
                addToConsole(`‚ùå Erro durante execu√ß√£o dos testes: ${error.message}`, 'error');
                updateTestStatus(`‚ùå Erro: ${error.message}`, 'error');
            } finally {
                isRunningTests = false;
            }
        };
        
        // Fun√ß√£o para limpar console
        window.clearConsole = function() {
            document.getElementById('consoleOutput').textContent = '';
            addToConsole('üßπ Console limpo!', 'info');
        };
        
        // Fun√ß√£o para atualizar resultados dos testes
        function updateTestResults() {
            const resultsDiv = document.getElementById('testResults');
            
            if (testResults.length === 0) {
                resultsDiv.innerHTML = '<p>Nenhum teste executado ainda.</p>';
                return;
            }
            
            let html = '';
            testResults.forEach((result, index) => {
                const statusClass = result.status === 'SUCCESS' ? 'success' : 'error';
                const statusIcon = result.status === 'SUCCESS' ? '‚úÖ' : '‚ùå';
                const timestamp = new Date(result.timestamp).toLocaleString('pt-BR');
                
                html += `
                    <div class="result-item">
                        <h4>${statusIcon} ${result.name}</h4>
                        <p><strong>Status:</strong> <span class="status ${statusClass}">${result.status}</span></p>
                        <p><strong>Mensagem:</strong> ${result.message}</p>
                        <p><strong>Timestamp:</strong> ${timestamp}</p>
                        ${result.data ? `<p><strong>Dados:</strong> ${JSON.stringify(result.data, null, 2)}</p>` : ''}
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            addToConsole('üöÄ Sistema de testes carregado com sucesso!', 'success');
            addToConsole('üìã Use os bot√µes acima para executar os testes.', 'info');
            updateTestStatus('üü¢ Sistema pronto para executar testes', 'success');
        });
        
        // Interceptar console.log para exibir na interface
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            addToConsole(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalConsoleWarn.apply(console, args);
            addToConsole(args.join(' '), 'warn');
        };
    </script>
</body>
</html>
