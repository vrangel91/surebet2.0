<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Content-Language" content="pt-BR">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#00ff88">
    <meta name="theme-color-media" content="(prefers-color-scheme: light)">
    <meta name="theme-color-media" content="(prefers-color-scheme: dark)" media="(prefers-color-scheme: dark)">
    
    <!-- Apple PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SureStake">
    
    <!-- Android PWA -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="SureStake">
    
    <!-- Windows PWA -->
    <meta name="msapplication-TileColor" content="#00ff88">
    <meta name="msapplication-TileImage" content="/img/logo-150x150.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- PWA Status Bar -->
    <meta name="status-bar-style" content="black-translucent">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="<%= BASE_URL %>manifest.json">
    
    <!-- PWA Icons -->
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="<%= BASE_URL %>img/logo-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="<%= BASE_URL %>img/logo-16x16.png">
    <link rel="apple-touch-icon" href="<%= BASE_URL %>img/logo-192x192.png">
    <link rel="mask-icon" href="<%= BASE_URL %>img/logo.svg" color="#00ff88">
    
    <title>SureStake</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
         <!-- CSS Personalizado para Barra do PWA -->
     <link rel="stylesheet" href="<%= BASE_URL %>css/pwa-titlebar.css">
     
     <!-- CSS Personalizado para Instalador PWA -->
     <link rel="stylesheet" href="<%= BASE_URL %>css/pwa-installer.css">
     
     <!-- Script de Configura√ß√£o do PWA -->
     <script src="<%= BASE_URL %>pwa-config.js"></script>
     
     <!-- Script do Instalador PWA Personalizado -->
     <script src="<%= BASE_URL %>js/pwa-installer.js"></script>
    
         <!-- Script de Configura√ß√£o do PWA -->
     <script>
       // üöÄ Configura√ß√£o do PWA - SureStake
       window.addEventListener('load', () => {
         // Verificar se o service worker foi registrado pelo Vue CLI
         if ('serviceWorker' in navigator) {
           navigator.serviceWorker.ready.then(registration => {
             console.log('‚úÖ Service Worker do Vue CLI ativo:', registration);
             
             // Verificar se h√° atualiza√ß√µes
             registration.addEventListener('updatefound', () => {
               console.log('üîÑ Nova vers√£o do Service Worker encontrada');
               
               const newWorker = registration.installing;
               newWorker.addEventListener('statechange', () => {
                 if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                   console.log('üîÑ Nova vers√£o dispon√≠vel, atualizando...');
                   
                   // Mostrar notifica√ß√£o de atualiza√ß√£o personalizada
                   showUpdateModal(newWorker);
                 }
               });
             });
           });
         }
       });
     </script>
  </head>
  <body>
    <noscript>
      <strong>Desculpe, mas este site n√£o funciona sem JavaScript habilitado. Por favor, habilite-o para continuar.</strong>
    </noscript>
    <div id="app"></div>
    
    <!-- Indicador de Carregamento do PWA -->
    <div id="pwa-loading-indicator" style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.3s ease;
    ">
      <div style="text-align: center; color: white;">
        <div style="
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, #00ff88, #00cc6a);
          border-radius: 50%;
          margin: 0 auto 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 24px;
          color: #1a1a1a;
          font-weight: bold;
          animation: pulse 2s infinite;
        ">S</div>
        <h2 style="color: #00ff88; margin-bottom: 10px;">SureStake</h2>
        <p style="color: #cccccc;">Carregando aplica√ß√£o...</p>
      </div>
    </div>
    
    <!-- Modal de Atualiza√ß√£o PWA -->
    <div id="pwa-update-modal" style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      transition: opacity 0.3s ease;
    ">
      <div style="
        background: var(--bg-primary, #2a2a2a);
        border: 1px solid var(--border-primary, rgba(255, 255, 255, 0.1));
        border-radius: var(--radius-lg, 12px);
        padding: var(--spacing-2xl, 32px);
        max-width: 400px;
        width: 90%;
        text-align: center;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transform: scale(0.9);
        transition: transform 0.3s ease;
      ">
        <!-- √çcone de Atualiza√ß√£o -->
        <div style="
          width: 64px;
          height: 64px;
          background: linear-gradient(135deg, var(--accent-color, #00ff88), var(--accent-hover, #00cc6a));
          border-radius: 50%;
          margin: 0 auto var(--spacing-lg, 20px);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 28px;
          color: var(--text-inverse, #1a1a1a);
          font-weight: bold;
          animation: pulse 2s infinite;
        ">üîÑ</div>
        
        <!-- T√≠tulo -->
        <h2 style="
          color: var(--text-primary, #ffffff);
          font-size: 24px;
          font-weight: 700;
          margin: 0 0 var(--spacing-md, 12px) 0;
          line-height: 1.2;
        ">Nova Vers√£o Dispon√≠vel</h2>
        
        <!-- Descri√ß√£o -->
        <p style="
          color: var(--text-secondary, #cccccc);
          font-size: 16px;
          margin: 0 0 var(--spacing-2xl, 32px) 0;
          line-height: 1.5;
        ">Uma nova vers√£o do SureStake est√° dispon√≠vel. Deseja atualizar agora?</p>
        
        <!-- Bot√µes -->
        <div style="
          display: flex;
          gap: var(--spacing-md, 12px);
          justify-content: center;
        ">
          <button id="update-later-btn" style="
            padding: var(--spacing-md, 12px) var(--spacing-xl, 24px);
            border: 1px solid var(--border-primary, rgba(255, 255, 255, 0.2));
            border-radius: var(--radius-md, 8px);
            background: transparent;
            color: var(--text-secondary, #cccccc);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
          ">Depois</button>
          
          <button id="update-now-btn" style="
            padding: var(--spacing-md, 12px) var(--spacing-xl, 24px);
            border: 1px solid var(--accent-color, #00ff88);
            border-radius: var(--radius-md, 8px);
            background: linear-gradient(135deg, var(--accent-color, #00ff88), var(--accent-hover, #00cc6a));
            color: var(--text-inverse, #1a1a1a);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 255, 136, 0.3);
          ">Atualizar Agora</button>
        </div>
      </div>
    </div>

    <!-- built files will be auto injected -->
    
    <script>
      // üöÄ Ocultar indicador de carregamento quando a aplica√ß√£o estiver pronta
      function hideLoadingIndicator() {
        const indicator = document.getElementById('pwa-loading-indicator');
        if (indicator) {
          indicator.style.opacity = '0';
          setTimeout(() => {
            indicator.remove();
          }, 300);
        }
      }
      
      // Ocultar indicador quando a aplica√ß√£o carregar
      if (document.readyState === 'complete') {
        setTimeout(hideLoadingIndicator, 1000);
      } else {
        window.addEventListener('load', () => {
          setTimeout(hideLoadingIndicator, 1000);
        });
      }
      
      // Ocultar indicador se a aplica√ß√£o j√° estiver carregada
      const appElement = document.getElementById('app');
      if (appElement && appElement.children.length > 0) {
        setTimeout(hideLoadingIndicator, 500);
      }
      
      // üé® Fun√ß√£o para mostrar modal de atualiza√ß√£o personalizado
      function showUpdateModal(newWorker) {
        const modal = document.getElementById('pwa-update-modal');
        const updateNowBtn = document.getElementById('update-now-btn');
        const updateLaterBtn = document.getElementById('update-later-btn');
        
        if (!modal) return;
        
        // Mostrar modal com anima√ß√£o
        modal.style.display = 'flex';
        setTimeout(() => {
          modal.style.opacity = '1';
          modal.querySelector('div').style.transform = 'scale(1)';
        }, 10);
        
        // Event listeners para os bot√µes
        updateNowBtn.addEventListener('click', () => {
          newWorker.postMessage({ type: 'SKIP_WAITING' });
          window.location.reload();
        });
        
        updateLaterBtn.addEventListener('click', () => {
          hideUpdateModal();
        });
        
        // Fechar modal ao clicar no fundo
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            hideUpdateModal();
          }
        });
      }
      
      // üé® Fun√ß√£o para ocultar modal de atualiza√ß√£o
      function hideUpdateModal() {
        const modal = document.getElementById('pwa-update-modal');
        if (!modal) return;
        
        modal.style.opacity = '0';
        modal.querySelector('div').style.transform = 'scale(0.9)';
        
        setTimeout(() => {
          modal.style.display = 'none';
        }, 300);
      }
    </script>
    
    <!-- CSS para anima√ß√µes e estilos do modal -->
    <style>
      /* Anima√ß√£o de pulso para o √≠cone */
      @keyframes pulse {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7);
        }
        70% {
          transform: scale(1.05);
          box-shadow: 0 0 0 10px rgba(0, 255, 136, 0);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(0, 255, 136, 0);
        }
      }
      
      /* Hover effects para os bot√µes */
      #update-later-btn:hover {
        background: rgba(255, 255, 255, 0.1) !important;
        border-color: rgba(255, 255, 255, 0.3) !important;
        transform: translateY(-1px);
      }
      
      #update-now-btn:hover {
        background: linear-gradient(135deg, #00ff88, #00cc6a) !important;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 255, 136, 0.4) !important;
      }
      
      /* Responsividade */
      @media (max-width: 480px) {
        #pwa-update-modal > div {
          padding: var(--spacing-xl, 24px) !important;
          margin: var(--spacing-md, 16px) !important;
        }
        
        #pwa-update-modal h2 {
          font-size: 20px !important;
        }
        
        #pwa-update-modal p {
          font-size: 14px !important;
        }
        
        #pwa-update-modal button {
          padding: var(--spacing-sm, 8px) var(--spacing-lg, 16px) !important;
          font-size: 13px !important;
        }
      }
    </style>
  </body>
</html>
